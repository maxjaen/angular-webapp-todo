<mat-tab-group>
   <!-- ###################### TODAY TAB ###################### -->
   <mat-tab label="Tasks">
      <div class="content">
         <div class="block">
            <div *ngIf="unpinnedTasks && pinnedTasks && unpinnedTasks.length == 0 && pinnedTasks.length == 0"
               style="margin-bottom: 100px;">
               <p>Can't find any tasks</p>
               <br>
               <mat-progress-bar mode="indeterminate"></mat-progress-bar>
            </div>
         </div>
         <div *ngIf="!focusedTask">
            <button class="fixedButtons control-buttons-gray" title="Create new task" (click)="openInsertTaskDialog()" mat-mini-fab>
               <mat-icon>create</mat-icon>
            </button>
            <div *ngIf="unpinnedTasks && pinnedTasks">
               <div class="largeToBottom" *ngIf="pinnedTasks.length > 0">
                  <h3>Pinned Tasks</h3>
                  <div *ngFor="let task of pinnedTasks; let i = index">
                     <div *ngIf="task == selectedTask" class="changeField"
                        style="margin: 2%; display: block; overflow: hidden;">
                        <form class="example-form">
                           <mat-form-field class="example-full-width" style="margin-right: 2%;">
                              <input matInput #message maxlength="50" placeholder="titel" name="shortdescr"
                                 [(ngModel)]="selectedTask.shortdescr" />
                              <mat-hint>{{ message.value.length }} / 50</mat-hint>
                           </mat-form-field>
                           <mat-form-field>
                              <input matInput (dateChange)="changeDateFromTask($event)" [matDatepicker]="picker"
                                 placeholder="Choose a date" />
                              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                              <mat-datepicker #picker></mat-datepicker>
                           </mat-form-field>
                           <mat-form-field class="example-full-width"
                              style="margin-right: 2%; width: 100%; margin-top: 50px;">
                              <textarea style="height: 300px;" matInput placeholder="description" name="longdescr"
                                 [(ngModel)]="selectedTask.longdescr"
                                 (ngModelChange)="replaceWithShortcut(selectedTask)"></textarea>
                           </mat-form-field>
                           <button (click)="saveAllTasks()" style="float:right" mat-button>
                              Save all
                           </button>
                           <button (click)="saveTask(selectedTask)" style="float:right" mat-button>
                              Save task
                           </button>
                        </form>
                     </div>
                     <!-- <mat-card [style.background-color]="task==selectedTask ? '#47556c' : '#424242'" (click)="selectTask(task);" style="margin: 2%; display: block; overflow: auto;" class="example-card"> -->
                     <mat-card class="example-card" (click)="selectTask(task)"> 
                        <div *ngIf="this.settings && settingsService.getSettingsValue(this.settings, 'Show status color')">
                           <div class="card-status" [style.background-color]="getBackgroundColorValue(task)">
                           </div>
                        </div>
                        <div style="width: 70%; display: inline-block;">
                           <mat-card-header>
                              <mat-card-title>
                                 {{ task.shortdescr }}
                                 <div
                                    *ngIf="this.settings && settingsService.getSettingsValue(this.settings, 'Show creation date')">
                                    <div style="margin-top: 20px; font-size: 12px;">
                                       {{ getUTCStringFromTask(task) }}
                                    </div>
                                 </div>
                              </mat-card-title>
                              <mat-card-subtitle *ngIf="task.longdescr && task.longdescr.length > 0">
                                 <ul *ngFor="let point of this.utilityService.split(task.longdescr)">
                                    <div *ngIf="point.length > 0">
                                       <li>{{ point }}</li>
                                    </div>
                                    <div *ngIf="point.length == 0">
                                       <hr />
                                    </div>
                                 </ul>
                              </mat-card-subtitle>
                           </mat-card-header>
                        </div>
                        <div style="display: flex; justify-content: flex-end; float: right;">
                           <button title="Focus" (click)="focusTask(task)" mat-button>
                              <mat-icon>center_focus_strong</mat-icon>
                           </button>   
                           <button title="Unpin" (click)="pinTask(task)" mat-button>
                              <mat-icon>public_off</mat-icon>
                           </button>
                           <button title="Archive" (click)="hideTask(task)" mat-button>
                              <mat-icon>move_to_inbox</mat-icon>
                           </button>
                           <button title="Delete" (click)="removeTask(task)" mat-button>
                              <mat-icon>delete</mat-icon>
                           </button>
                           <!-- <button (click)="this.utilityService.changeTasksOrder(unpinnedTasks, 'unten', i)" mat-stroked-button>Down</button>
                           <button (click)="this.utilityService.changeTasksOrder(unpinnedTasks, 'oben', i)" mat-stroked-button>Up</button> -->
                        </div>
                     </mat-card>
                  </div>
               </div>
               <div *ngIf="unpinnedTasks.length > 0">
                  <h3>Unpinned Tasks</h3>
                  <div *ngFor="let task of unpinnedTasks; let i = index">
                     <div *ngIf="task == selectedTask" class="changeField"
                        style="margin: 2%; display: block; overflow: hidden;">
                        <form class="example-form">
                           <mat-form-field class="example-full-width" style="margin-right: 2%;">
                              <input matInput #message maxlength="50" placeholder="titel" name="shortdescr"
                                 [(ngModel)]="selectedTask.shortdescr" />
                              <mat-hint>{{ message.value.length }} / 50</mat-hint>
                           </mat-form-field>
                           <mat-form-field>
                              <input matInput (dateChange)="changeDateFromTask($event)" [matDatepicker]="picker"
                                 placeholder="Choose a date" />
                              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                              <mat-datepicker #picker></mat-datepicker>
                           </mat-form-field>
                           <mat-form-field class="example-full-width"
                              style="margin-right: 2%; width: 100%; margin-top: 50px;">
                              <textarea style="height: 300px;" matInput placeholder="description" name="longdescr"
                                 [(ngModel)]="selectedTask.longdescr"
                                 (ngModelChange)="replaceWithShortcut(selectedTask)"></textarea>
                           </mat-form-field>
                           <button (click)="saveAllTasks()" style="float:right" mat-button>
                              Save all
                           </button>
                           <button (click)="saveTask(selectedTask)" style="float:right" mat-button>
                              Save task
                           </button>
                        </form>
                     </div>
                     <mat-card class="example-card" (click)="selectTask(task)"> 
                        <div *ngIf="this.settings && settingsService.getSettingsValue(this.settings, 'Show status color')">
                           <div class="card-status"
                              [style.background-color]="getBackgroundColorValue(task)"></div>
                        </div>
                        <div style="width: 70%; display: inline-block;">
                           <mat-card-header>
                              <mat-card-title>
                                 {{ task.shortdescr }}
                                 <div
                                    *ngIf="this.settings && settingsService.getSettingsValue(this.settings, 'Show creation date')">
                                    <div style="margin-top: 20px; font-size: 12px;">
                                       {{ getUTCStringFromTask(task) }}
                                    </div>
                                 </div>
                              </mat-card-title>
                              <mat-card-subtitle *ngIf="task.longdescr && task.longdescr.length > 0">
                                 <ul *ngFor="let point of this.utilityService.split(task.longdescr)">
                                    <div *ngIf="point.length > 0">
                                       <li>{{ point }}</li>
                                    </div>
                                    <div *ngIf="point.length == 0">
                                       <hr />
                                    </div>
                                 </ul>
                              </mat-card-subtitle>
                           </mat-card-header>
                        </div>
                        <div style="display: flex; justify-content: flex-end; float: right;">
                           <button title="Pin task" (click)="pinTask(task)" mat-button>
                              <mat-icon>push_pin</mat-icon>
                           </button>
                           <button title="Archive task" (click)="hideTask(task)" mat-button>
                              <mat-icon>move_to_inbox</mat-icon>
                           </button>
                           <button title="Delete task" (click)="removeTask(task)" mat-button>
                              <mat-icon>delete</mat-icon>
                           </button>                           
                           <!-- <button (click)="changeTasksOrder(unpinnedTasks, 'unten', i)" mat-stroked-button>Down</button>
                           <button (click)="changeTasksOrder(unpinnedTasks, 'oben', i)" mat-stroked-button>Up</button> -->
                        </div>

                     </mat-card>
                  </div>
               </div>
            </div>
         </div>
         <div *ngIf="focusedTask">
            <div style="margin-bottom: 40px;">
               <button (click)="focusTask(focusedTask)" mat-button>🜄</button>
               <button (click)="removeTask(focusedTask)" mat-button>🜂</button>
               <hr>
            </div>
            <div style="text-align: center;">
               <h2 style="font-size: 50px;">{{ this.focusedTask.shortdescr }}</h2>
               <div *ngFor="let point of this.utilityService.split(this.focusedTask.longdescr)">
                  <div *ngIf="point.length > 0">
                     <p>{{ point }}</p>
                  </div>
                  <div *ngIf="point.length == 0">
                     <hr />
                  </div>
               </div>
            </div>
         </div>
      </div>
   </mat-tab>
   <mat-tab label="History">
      <div class="content" *ngIf="hidedElements">
         <div *ngFor="let task of hidedElements">
             <div *ngIf="task == selectedTask" class="changeField"
                        style="margin: 2%; display: block; overflow: hidden;">
               <form class="example-form">
                  <mat-form-field class="example-full-width" style="margin-right: 2%;">
                     <input matInput #message maxlength="50" placeholder="titel" name="shortdescr"
                        [(ngModel)]="selectedTask.shortdescr" />
                     <mat-hint>{{ message.value.length }} / 50</mat-hint>
                  </mat-form-field>
                  <mat-form-field>
                     <input matInput (dateChange)="changeDateFromTask($event)" [matDatepicker]="picker"
                        placeholder="Choose a date" />
                     <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                     <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>
                  <mat-form-field class="example-full-width"
                     style="margin-right: 2%; width: 100%; margin-top: 50px;">
                     <textarea style="height: 300px;" matInput placeholder="description" name="longdescr"
                        [(ngModel)]="selectedTask.longdescr"
                        (ngModelChange)="replaceWithShortcut(selectedTask)"></textarea>
                  </mat-form-field>
                  <button (click)="saveAllTasks()" style="float:right" mat-button>
                     Save all
                  </button>
                  <button (click)="saveTask(selectedTask)" style="float:right" mat-button>
                     Save task
                  </button>
               </form>
            </div>
            <mat-card (click)="selectTask(task)" style="margin: 2%; display: block; overflow: hidden;" class="example-card">
               <div style="width: 70%; display: inline-block;">
                  <mat-card-header>
                     <mat-card-title>
                        {{ task.shortdescr }}
                         <div *ngIf="this.settings && settingsService.getSettingsValue(this.settings, 'Show creation date')">
                           <div style="margin-top: 20px; font-size: 12px;">
                              {{ getUTCStringFromTask(task) }}
                           </div>
                        </div>
                     </mat-card-title>
                     <mat-card-subtitle *ngIf="task.longdescr && task.longdescr.length > 0">
                        <ul *ngFor="let point of this.utilityService.split(task.longdescr)">
                           <div *ngIf="point.length > 0">
                              <li>{{ point }}</li>
                           </div>
                           <div *ngIf="point.length == 0">
                              <hr />
                           </div>
                        </ul>
                     </mat-card-subtitle>
                  </mat-card-header>
               </div>
               <div style="display: flex; justify-content: flex-end; float: right;">
                  <button title="Unarchive" (click)="hideTask(task)" mat-button>
                     <mat-icon>move_to_inbox</mat-icon>
                  </button>
                  <button title="Delete" (click)="removeTask(task)" mat-button>
                     <mat-icon>delete</mat-icon>
                  </button>
                           <!-- <button (click)="this.utilityService.changeTasksOrder(unpinnedTasks, 'unten', i)" mat-stroked-button>Down</button>
                           <button (click)="this.utilityService.changeTasksOrder(unpinnedTasks, 'oben', i)" mat-stroked-button>Up</button> -->
               </div>
            </mat-card>
         </div>
      </div>
   </mat-tab>>
</mat-tab-group>